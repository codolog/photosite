# Экспедиции ДТЮ — сайт истории экспедиционного движения

Сайт биологического отдела Дворца Творчества Юных города Ижевска: история экспедиций по годам, галерея фотографий с подписями, тегами и отметками людей, комментарии. Небольшая социальная сеть для участников движения.

## Возможности

- **История** — разделы по годам, даты, места, списки участников экспедиций (редактирует только админ).
- **Галерея** — фильтры по году, экспедиции, человеку, тегу.
- **Фото** — подпись, привязка к экспедиции, место и дата съёмки, теги, отметки людей на фото (клик по фото + имя). Поиск по людям и тегам.
- **Комментарии** — к любому фото, все залогиненные пользователи.
- **Загрузка фото** — все зарегистрированные пользователи.
- **Админка** — одна учётная запись (email задаётся в `.env`): добавление и редактирование экспедиций.

## Стек

- Next.js 14 (App Router), TypeScript, Tailwind CSS
- Supabase: Auth, PostgreSQL, Storage (фото)

## Запуск локально

1. Установите зависимости:
   ```bash
   npm install
   ```

2. Создайте проект на [supabase.com](https://supabase.com), в настройках возьмите **Project URL** и **anon public** key.

3. В корне проекта создайте файл `.env.local` (по образцу `.env.local.example`):
   - `NEXT_PUBLIC_SUPABASE_URL` — URL проекта Supabase
   - `NEXT_PUBLIC_SUPABASE_ANON_KEY` — anon key
   - `ADMIN_EMAIL` — email единственного админа (для доступа в админку)

4. В панели Supabase откройте **SQL Editor** и выполните скрипт из файла `supabase/schema.sql` (создаст таблицы, RLS и триггеры).

5. В Supabase: **Storage** → создайте bucket с именем `photos`, сделайте его **Public** (чтобы фото отдавались по ссылке). Политики для `storage.objects` уже заданы в `schema.sql` (если что-то не применится — настройте вручную: чтение всем, загрузка/удаление для authenticated).

6. Запуск:
   ```bash
   npm run dev
   ```
   Сайт: [http://localhost:3000](http://localhost:3000).

7. Зарегистрируйте пользователя с email из `ADMIN_EMAIL` и войдите — в шапке появится пункт «Админка». Остальные пользователи регистрируются свободно и могут загружать фото и комментировать.

## Деплой (бесплатно)

- **Frontend**: Vercel или Netlify (подключите репозиторий, задайте те же переменные окружения).
- **Бэкенд**: Supabase уже в облаке; для продакшена укажите в настройках проекта Vercel/Netlify `NEXT_PUBLIC_SITE_URL` на ваш домен (для корректного редиректа после выхода).

После деплоя создайте bucket `photos` в Supabase и проверьте, что в нём включён публичный доступ.
